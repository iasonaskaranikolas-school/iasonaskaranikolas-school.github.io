<!DOCTYPE html>
<html>

<head>
    <title>School Schedule</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../css/main.css">
    <script src="https://cdn.jasonkaranik.tk/files/2epal_xalandriou_schedule_grabber.js"></script>
    <script>
        window.addEventListener("DOMContentLoaded", async () => {
            try {
                const params = new URLSearchParams(document.location.search);

                const table = params.has("table") ? params.get("table") : "table_2";
                const header = params.has("header") ? params.get("header") : "";

                console.log(params.get("table"));

                try {
                    document.getElementById("header").innerText = header;
                } catch { }

                const sched = await grabSchedule(table);
                if (sched !== null && sched !== undefined) {
                    const tbody = document.getElementById("tbody");
                    if (tbody !== null && tbody !== undefined) {
                        for (const i in sched) {
                            if (sched[i] !== null && sched[i] !== undefined) {
                                const day = sched[i];
                                const tr = document.createElement("tr");
                                const th = document.createElement("th");
                                th.innerText = day.title;
                                tr.appendChild(th);
                                for (const i2 in day.lessons) {
                                    if (day.lessons[i2] !== null && day.lessons[i2] !== undefined) {
                                        const lesson = day.lessons[i2];
                                        const td = document.createElement("td");
                                        td.innerHTML = `<div><span>${lesson.name}</span></div>`;
                                        if ((lesson.size !== null && lesson.size !== undefined) && (lesson.size !== 0)) {
                                            td.setAttribute("colspan", lesson.size);
                                        }
                                        tr.appendChild(td);
                                    }
                                }
                                tbody.appendChild(tr);
                            }
                        }
                    }
                }
            } catch (e) {
                console.log(e);
            }
        });
    </script>
</head>

<body>
    <div>
        <table>
            <thead>
                <tr>
                    <td rowspan="2"></td>
                    <th colspan="7" id="header"></th>
                </tr>
                <tr>
                    <th>1η</th>
                    <th>2η</th>
                    <th>3η</th>
                    <th>4η</th>
                    <th>5η</th>
                    <th>6η</th>
                    <th>7η</th>
                </tr>
            </thead>
            <tbody id="tbody">

            </tbody>
        </table>
    </div>
</body>

</html>